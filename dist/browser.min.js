if(void 0===SUNRUSE)var SUNRUSE={};SUNRUSE.math=SUNRUSE.math||{},SUNRUSE.math.vector=function(){var a={};return a.add=function(b,c,d){a.zip(b,c,d,function(a,b){return a+b})},a.subtract=function(b,c,d){a.zip(b,c,d,function(a,b){return a-b})},a.multiply=function(b,c,d){a.zip(b,c,d,function(a,b){return a*b})},a.divide=function(b,c,d){a.zip(b,c,d,function(a,b){return a/b})},a.dot=function(b,c){return a.zipFold(b,c,function(a,b){return a*b},function(a,b){return a+b})},a.cross=function(a,b,c){var d,e,f;a instanceof Array?(d=a[0],e=a[1],f=a[2]):(d=a,e=a,f=a);var g,h,i;b instanceof Array?(g=b[0],h=b[1],i=b[2]):(g=b,h=b,i=b),c[0]=e*i-f*h,c[1]=f*g-d*i,c[2]=d*h-e*g},a.reflect=function(b,c,d){var e=2*a.dot(b,c);a.zip(b,c,d,function(a,b){return a-b*e})},a.sum=function(b){return a.fold(b,function(a,b){return a+b})},a.product=function(b){return a.fold(b,function(a,b){return a*b})},a.map=function(a,b,c){if(a instanceof Array)for(var d=0;d<a.length;d++)b[d]=c(a[d]);else b[0]=c(a)},a.zip=function(a,b,c,d){if(a instanceof Array)if(b instanceof Array)for(var e=0;e<a.length;e++)c[e]=d(a[e],b[e]);else for(var e=0;e<a.length;e++)c[e]=d(a[e],b);else if(b instanceof Array)for(var e=0;e<b.length;e++)c[e]=d(a,b[e]);else c[0]=d(a,b)},a.fold=function(a,b){if(a instanceof Array){for(var c=a[0],d=1;d<a.length;d++)c=b(c,a[d]);return c}return a},a.zipFold=function(a,b,c,d){if(a instanceof Array){if(b instanceof Array){for(var e=c(a[0],b[0]),f=1;f<a.length;f++)e=d(e,c(a[f],b[f]));return e}for(var e=c(a[0],b),f=1;f<a.length;f++)e=d(e,c(a[f],b));return e}if(b instanceof Array){for(var e=c(a,b[0]),f=1;f<b.length;f++)e=d(e,c(a,b[f]));return e}return c(a,b)},a.magnitudeSquared=function(b){return a.dot(b,b)},a.magnitude=function(b){return Math.sqrt(a.magnitudeSquared(b))},a.distanceSquared=function(b,c){return a.zipFold(b,c,function(a,b){var c=a-b;return c*c},function(a,b){return a+b})},a.distance=function(b,c){return Math.sqrt(a.distanceSquared(b,c))},a.clone=function(b,c){a.map(b,c,function(a){return a})},a.negate=function(b,c){a.map(b,c,function(a){return-a})},a}();